<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../lib/bootstrap/css/bootstrap.min.css" />
<link rel="stylesheet" type="text/css" href="../css/bootstrap_yeti.css">
<link rel="stylesheet" type="text/css" href="../css/reviewFormCss.css">

<script src="../lib/jquery/jquery.js"></script>
<script src="../lib/blueimp-file-upload/js/vendor/jquery.ui.widget.js"></script>
<script src="../lib/blueimp-file-upload/js/jquery.iframe-transport.js"></script>
<script src="../lib/blueimp-file-upload/js/jquery.fileupload.js"></script>
<script src="../js/common.js"></script>
<title>Review</title>
<script>
	$(document).ready(function() {
		$('#top').load('top.html').trigger('pagecreate');
	});
	
	// 성형정보 공유 disabled
	function checkDisable(frm)
	{
	    if( frm.share.checked == true ){
	       /*
	       frm.eyes.disabled = false;
		   frm.nose.disabled = false;
		   frm.chin.disabled = false;
		   frm.cheekbone.disabled = false;
		   frm.outline.disabled = false;
		   frm.bimaxillary.disabled = false;
		   frm.breast.disabled = false;
		   frm.liposuction.disabled = false;
		   frm.injection.disabled = false;
		   */
		   frm.way.disabled = false;
		   frm.hsName.disabled = false;
		   frm.doctor.disabled = false;
		   frm.price.disabled = false;
		   frm.date.disabled = false;
		} 
	    else 
		{
	    	/*
		   frm.eyes.disabled = true;
		   frm.nose.disabled = true;
		   frm.chin.disabled = true;
		   frm.cheekbone.disabled = true;
		   frm.outline.disabled = true;
		   frm.bimaxillary.disabled = true;
		   frm.breast.disabled = true;
		   frm.liposuction.disabled = true;
		   frm.injection.disabled = true;
		   */
		   frm.way.disabled = true;
		   frm.hsName.disabled = true;
		   frm.doctor.disabled = true;
		   frm.price.disabled = true;
		   frm.date.disabled = true;
		}
	}
	
function ckSubmit() {
		
		console.log(contextRoot);
		/*
		var checkBoxValues = [];
		
		$('#sugeryPart:checked').each(function(i) {
			checkBoxValues.push($(this).val());
		});
		
		var allData = {};
		
		if($('input:checkbox[id="status"]').is(':checked') == true){
			allData = {
					title : $('#title').val(),
					content : $('#content').val(),
					fileName : $('#fileName').val()
					
			};
		}else{
			allData = {
					memberNo : 1,
					title : $('#title').val(),
					content : $('#content').val(),
					fileName : $('#fileName')[0].files[0],
					sugeryPart : "눈,코",
					status : "1"
					
			};
			
		}
		console.log(allData);
		
		return false;
		*/
	}
	
	
</script>
<style type="text/css">
	.checkData{
		width: 70px !important;
		padding-left: 0px !important;
		padding-right: 0px !important;
		font-size: 9pt;
	}
	.checkBox{
		padding-left: 15px; 
	}
	@media screen and (max-width: 1024px) {
		.floatForm {
			float: left;
			width: 380px;
			height: 700px;
			margin-left: auto;
			margin-left: 30px;
			margin-top: 20px;
		}
	}
	.ffile{
		display: none !important; 
	}
</style>
<script>
$(document).ready(function() {
	$.getJSON(contextRoot + '/cosmetic/ajax/loginCheck.do', function(resultObj) {
		var ajaxResult = resultObj.ajaxResult;
		var member = ajaxResult.data;
		if(member != null){
			console.log(member.id);
			$('.changeValue1').html('LOGOUT').attr('onclick','return logout();');
			$('.changeValue2').html('Hello '+member.id).removeAttr('onclick');
		}
	}).error(function(error) {
		window.location.href='login.html';
	});
});

</script>
</head>
<body>
	<!-- top -->
	<div data-role="page" id="top"></div>
	
<div class="body-content">
	<div class="body-detail">
<form id="mForm" class="form-horizontal" enctype="multipart/form-data">
	<fieldset>
	    <legend><h3 style="color: #cf2d39;">Review</h3></legend>
	    <div class="float">
	    	<img src="..\images\reviewForm.png" width="450px">
	    </div>
	    <div class="floatForm">
	    <div class="form-group">
	      <label for="inputEmail" class="col-lg-2 control-label">제　　목</label>
	      <div class="col-lg-10">
	        <input type="text" class="form-control fontStyle" id="title" placeholder="Title">
	      </div>
	    </div>
	    <div class="form-group">
	      <label for="textArea" class="col-lg-2 control-label">후　　기</label>
	      <div class="col-lg-10">
	        <textarea class="form-control fontStyle" rows="8" id="content" placeholder="Review"></textarea>
	        <span class="help-block" style="font-size: 6pt; color: gray;">*자신의 변화에 대한 상세한 후기를 적어주세요.</span>
	      </div>
	    </div>
	    <div class="form-group">
	      <label for="inputEmail" class="col-lg-2 control-label">사　　진</label>
	      
	     <div class="row">
	     
		  <div class="col-md-4">
		  <div class="panel panel-default">
			  <div class="panel-body">
			    <img style="max-width:110px; max-height: 100px; width: auto; height: auto;" id="file-img1" name="path" src="http://www.randomlengthsnews.com/wp-content/themes/gonzo/images/no-image-blog-one.png"/>
			    <input type="file" name="files" id="ffile1" class="ffile" multiple />
			  </div>
			  <div class="panel-footer">BEFORE</div>
			</div>
		</div>
		
		  <div class="col-md-4">
		  <div class="panel panel-default">
			  <div class="panel-body">
			    <img style="max-width:110px; max-height: 100px; width: auto; height: auto;" id="file-img2" name="path" src="http://www.randomlengthsnews.com/wp-content/themes/gonzo/images/no-image-blog-one.png"/>
			    <input type="file" name="files" id="ffile2" class="ffile" multiple>
			  </div>
			  <div class="panel-footer">AFTER</div>
			</div>
		  </div>
		
		</div>
	      	
			
		<!--
	      <div class="col-lg-10">
	      <div class="panel panel-default">
			  <div class="panel-body">
			    Panel content
			  </div>
			  <div class="panel-footer">Panel footer</div>
			</div>
	      <input type="text" class="file_input_textbox" readonly="readonly"/>
	      <div class="file_input_div">
	      <input type="file" id="ffile" name="files" class="fontStyle" multiple>
	      </div>
	      </div>
	      -->
	    </div>
	    
	    <div class="form-group">
	      <label for="inputPassword" class="col-lg-2 control-label">수술 부위</label>
	      <div class="col-lg-10">
	      <div class="row checkBox">
	      	  <div class="col-md-1 checkData">
	      	  	<input class="sugeryPart" name="sPartCk" type="checkbox" value="눈" />눈
	      	  </div>
			  <div class="col-md-1 checkData">
			  	<input class="sugeryPart" name="sPartCk" type="checkbox" value="코">코
			  </div>
			  <div class="col-md-1 checkData">
				<input class="sugeryPart" name="sPartCk" type="checkbox" value="턱"/>턱	
			  </div>
			  <div class="col-md-1 checkData">
				<input class="sugeryPart" name="sPartCk" type="checkbox" value="광대"/>광대
			  </div>
			  <div class="col-md-1 checkData">
				<input class="sugeryPart" name="sPartCk" type="checkbox" value="윤곽"/>윤곽
			  </div>
			  <div class="col-md-1 checkData">
			  	<input class="sugeryPart" name="sPartCk" type="checkbox" value="양악"/>양악
			  </div>
			  <div class="col-md-1 checkData">
			  	<input class="sugeryPart" name="sPartCk" type="checkbox" value="가슴"/>가슴
			  </div>
			  <div class="col-md-1 checkData">
			  	<input class="sugeryPart" name="sPartCk" type="checkbox" value="지방흡입"/>지방흡입
			  </div>
			  <div class="col-md-1 checkData">
			  	<input class="sugeryPart" name="sPartCk" type="checkbox" value="쁘띠성형"/>쁘띠성형
			  </div>
	      </div>
			  <span class="help-block textMargin" style="font-size: 8pt; color: #cf2d39;"> *수술받은 부위를 체크해주세요.　(중복가능)</span>
	      </div>
	    </div>
	    
	    <div class="form-group">
	      <label for="inputPassword" class="col-lg-2 control-label">공유 여부</label>
	      <div class="col-lg-10">
	        <div class="checkbox">
	          <label>
	            <input id="ckStatus" type="checkbox" checked="checked" name="share" onclick="checkDisable(this.form)">
				<span style="font-size: 9pt;">당신의 성형 정보를 공유 하시겠습니까?</span>
	          </label>
	          <span class="help-block textMargin" style="font-size: 6pt; color: #cf2d39;"> *공유하지 않는다면, 다른 이용자들의 정보 요청 쪽지 세례를 받으실 수 있습니다.</span>
	        </div>
	      </div>
	    </div>
	    
	    
	    <div class="form-group">
	      <label for="inputEmail" class="col-lg-2 control-label">수술 방법</label>
	      <div class="col-lg-10">
	        <input name="way" type="text" class="form-control fontStyle boxSize" id="inputEmail" placeholder="체크한 수술의 수술 방법을 입력해주세요.　ex) 눈:매몰법, 코:매부리코">
	      </div>
	    </div>
	    <div class="form-group">
	      <label for="inputEmail" class="col-lg-2 control-label">병원 이름</label>
	      <div class="col-lg-10">
	        <input name="hsName" type="text" class="form-control fontStyle boxSize" id="inputEmail" placeholder="수술 받은 병원의 이름을 입력해주세요.">
	      </div>
	    </div>
	    <div class="form-group">
	      <label for="inputEmail" class="col-lg-2 control-label">담당 의사</label>
	      <div class="col-lg-10">
	        <input name="doctor" type="text" class="form-control fontStyle boxSize" id="inputEmail" placeholder="수술 받은 의사의 이름을 입력해주세요.">
	      </div>
	    </div>
	    <div class="form-group">
	      <label for="inputEmail" class="col-lg-2 control-label">수술 비용</label>
	      <div class="col-lg-10">
	        <input name="price" type="text" class="form-control fontStyle boxSize" id="inputEmail" placeholder="ex) 200만원">
	      </div>
	    </div>
	    <div class="form-group">
	      <label for="inputEmail" class="col-lg-2 control-label">수술 시기</label>
	      <div class="col-lg-10">
	        <input name="date" type="text" class="form-control fontStyle boxSize" id="inputEmail" placeholder="수술 받은 날짜를 입력해주세요.">
	      </div>
	    </div>
	    </div>
	</div>
	    <div class="form-group">
	    	<div class="modal-footer paddingZero" >
				<button type="button" id="cancelBtn" class="btn btn-default buttonWhite" data-dismiss="modal">Cancel</button>
				<button type="button" class="btn btn-primary" id="writeBtn">Write</button>
			</div>
		</div>
	</fieldset>
</form>
</div>
<script type="text/javascript">

$('.ffile').fileupload({
	url: contextRoot + '/cosmetic/ajax/reviewAdd.do',
	type : 'POST',
	dataType: 'json',
	singleFileUploads: false, // 서버에 한 번만 요청을 보내라.
	add: function (e, data) {
    //data.context = $('<p/>').text('Uploading...').appendTo(document.body);
	var ckIdx = 1;
	var sPart ='';
	var length = $('input:checkbox[name="sPartCk"]:checked').length;
	
    $('input:checkbox[name="sPartCk"]').each(function() {
		if(this.checked){
			if(ckIdx == 1){
				sPart += this.value;
				ckIdx++;
			}
			else{
				sPart += ','+this.value;
				ckIdx++;
			}
		}
	});
    console.log("파일을 추가하였음...");
    $('#writeBtn').click(function(event) {
    	  console.log(data);
    	  console.log("서버에 전송함...");
	    	data.formData = {
	    			memberNo: 1,
	    			title: $('#title').val(),
	    			content: $('#content').val(),
	    			sugeryPart : sPart,
					status : "0"
	    	};
     	data.submit();
    });
  },
  done: function (e, data) {
	  console.log(data.result.ajaxResult);
	  location.href = 'user_review_list.html';
  }
});

$('#cancelBtn').click(function() {
	location.href = 'user_review_list.html';
});

// 파일 미리보기 부분
$('#file-img1').click(function() {
	$('#ffile1').trigger('click');
});

$('#file-img2').click(function() {
	$('#ffile2').trigger('click');
});

$('.panel-body').find('.ffile').change(function() {
	readURL(this);
});
/*
$('.panel-body').find('[name=files2]').change(function() {
	console.log(this);
	readURL(this);
});
*/
function readURL(input) {
	if(input.files && input.files[0]){
		var reader = new FileReader();//파일을 읽기 위한 FileReader 객체생성
		reader.onload = function (e) {
			var inputId = $(input).prev().context.id;
			
			switch (inputId) {
			case 'ffile1':
				$('#file-img1').attr('src',e.target.result);
				break;
			case 'ffile2':
				$('#file-img2').attr('src',e.target.result);
				break;
			}
			// 파일 읽어들이기를 성공했을때 호출되는 이벤트 핸들러
			// 이미지 Tag의 src속성에 읽어들인 File 내용을 지정
			// 아래코드에서 읽어들인 dataURL형식
		};
		reader.readAsDataURL(input.files[0]);
	}
}

</script>
</body>
</html>